"use strict";(self.webpackChunktrinity_validator=self.webpackChunktrinity_validator||[]).push([[6048],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>h});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=o.createContext({}),d=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=d(e.components);return o.createElement(s.Provider,{value:n},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(t),m=a,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||r;return t?o.createElement(h,i(i({ref:n},p),{},{components:t})):o.createElement(h,i({ref:n},p))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:a,i[1]=l;for(var d=2;d<r;d++)i[d]=t[d];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7386:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var o=t(7462),a=(t(7294),t(3905));const r={title:"Run the Node",description:"Start your node",sidebar_position:6},i=void 0,l={unversionedId:"sentinelguides/node/node-run",id:"sentinelguides/node/node-run",title:"Run the Node",description:"Start your node",source:"@site/docs/sentinelguides/node/node-run.md",sourceDirName:"sentinelguides/node",slug:"/sentinelguides/node/node-run",permalink:"/docs/sentinelguides/node/node-run",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/sentinelguides/node/node-run.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Run the Node",description:"Start your node",sidebar_position:6},sidebar:"sentinelSidebar",previous:{title:"Node Configuration",permalink:"/docs/sentinelguides/node/node-config"},next:{title:"Monitoring with Uptime Kuma",permalink:"/docs/sentinelguides/node/monitoring"}},s={},d=[{value:"Enabling Autorestart Function",id:"enabling-autorestart-function",level:2},{value:"Wireguard",id:"wireguard",level:3},{value:"V2Ray",id:"v2ray",level:3},{value:"Without Autorestart Function",id:"without-autorestart-function",level:2},{value:"Create a Screen session",id:"create-a-screen-session",level:3},{value:"Run the Node",id:"run-the-node",level:3},{value:"Detach from the screen session",id:"detach-from-the-screen-session",level:3},{value:"Post Node Run Commands",id:"post-node-run-commands",level:2}],p={toc:d},u="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Running a node can be done in two ways: with or without the autorestart function. If you do not want to use it, you need to use a screen session to detach from the node after launching the docker run command."),(0,a.kt)("h2",{id:"enabling-autorestart-function"},"Enabling Autorestart Function"),(0,a.kt)("p",null,"To use autorestart function you must have set ",(0,a.kt)("inlineCode",{parentName:"p"},"backend='test'")," on ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," file. This is the easiest way, as it doesn't require the passphrase to be entered every time the node stops for any reason. However, it's worth noting that this solution is not recommended."),(0,a.kt)("h3",{id:"wireguard"},"Wireguard"),(0,a.kt)("p",null,"To run the node, use the following command and remember to include the ports you chose in your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"wireguard.toml")," files (in this example, replace ",(0,a.kt)("inlineCode",{parentName:"p"},"<API_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"7777")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<WIREGUARD_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"8888")," (without the ",(0,a.kt)("inlineCode",{parentName:"p"},"'<'")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"'>'"),"):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -d \\\n    --name sentinel-dvpn-node \\\n    --restart unless-stopped \\\n    --volume ${HOME}/.sentinelnode:/root/.sentinelnode \\\n    --volume /lib/modules:/lib/modules \\\n    --cap-drop ALL \\\n    --cap-add NET_ADMIN \\\n    --cap-add NET_BIND_SERVICE \\\n    --cap-add NET_RAW \\\n    --cap-add SYS_MODULE \\\n    --sysctl net.ipv4.ip_forward=1 \\\n    --sysctl net.ipv6.conf.all.disable_ipv6=0 \\\n    --sysctl net.ipv6.conf.all.forwarding=1 \\\n    --sysctl net.ipv6.conf.default.forwarding=1 \\\n    --publish <API_PORT>:<API_PORT>/tcp \\\n    --publish <WIREGUARD_PORT>:<WIREGUARD_PORT>/udp \\\n    sentinel-dvpn-node process start\n")),(0,a.kt)("h3",{id:"v2ray"},"V2Ray"),(0,a.kt)("p",null,"To run the node, use the following command and remember to include the ports you chose in your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"v2ray.toml")," files (in this example, replace ",(0,a.kt)("inlineCode",{parentName:"p"},"<API_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"7777")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<V2RAY_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"9999")," (without the ",(0,a.kt)("inlineCode",{parentName:"p"},"'<'")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"'>'"),"):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'docker run -d \\\n    --restart unless-stopped \\\n    --volume "${HOME}/.sentinelnode:/root/.sentinelnode" \\\n    --publish <API_PORT>:<API_PORT>/tcp \\\n    --publish <V2RAY_PORT>:<V2RAY_PORT>/tcp \\\n    sentinel-dvpn-node process start\n')),(0,a.kt)("h2",{id:"without-autorestart-function"},"Without Autorestart Function"),(0,a.kt)("p",null,"If you prefer not to initiate your node using the autorestart function, you should employ a screen session to detach from the node after executing the docker run command."),(0,a.kt)("h3",{id:"create-a-screen-session"},"Create a Screen session"),(0,a.kt)("p",null,"Before running the node, we recommend starting a screen session to run the Docker command. First, install the screen package"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install screen\n")),(0,a.kt)("p",null,"Open a new screen session with the following command (\"dvpn' is the session name)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"screen -t dvpn -S dvpn\n")),(0,a.kt)("p",null,"Use the appropriate command to run the node based on the node type specified in the config.toml file. Wireguard To run the node, use the following command and remember to include the TCP and UDP ports"),(0,a.kt)("h3",{id:"run-the-node"},"Run the Node"),(0,a.kt)("p",null,"Depending on the protocol you have selected, run the corresponding command"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Wireguard")),(0,a.kt)("p",null,"To run the node, use the following command and remember to include the ports you chose in your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"wireguard.toml")," files (in this example, replace ",(0,a.kt)("inlineCode",{parentName:"p"},"<API_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"7777")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<WIREGUARD_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"8888")," (without the ",(0,a.kt)("inlineCode",{parentName:"p"},"'<'")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"'>'"),"):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --rm \\\n    --name sentinel-dvpn-node \\\n    --interactive \\\n    --tty \\\n    --volume ${HOME}/.sentinelnode:/root/.sentinelnode \\\n    --volume /lib/modules:/lib/modules \\\n    --cap-drop ALL \\\n    --cap-add NET_ADMIN \\\n    --cap-add NET_BIND_SERVICE \\\n    --cap-add NET_RAW \\\n    --cap-add SYS_MODULE \\\n    --sysctl net.ipv4.ip_forward=1 \\\n    --sysctl net.ipv6.conf.all.disable_ipv6=0 \\\n    --sysctl net.ipv6.conf.all.forwarding=1 \\\n    --sysctl net.ipv6.conf.default.forwarding=1 \\\n    --publish <API_PORT>:<API_PORT>/tcp \\\n    --publish <WIREGUARD_PORT>:<WIREGUARD_PORT>/udp \\\n    sentinel-dvpn-node process start\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"V2Ray")),(0,a.kt)("p",null,"To run the node, use the following command and remember to include the ports you chose in your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"v2ray.toml")," files (in this example, replace ",(0,a.kt)("inlineCode",{parentName:"p"},"<API_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"7777")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<V2RAY_PORT>")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"9999")," (without the ",(0,a.kt)("inlineCode",{parentName:"p"},"'<'")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"'>'"),"):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'docker run --rm \\\n    --interactive \\\n    --tty \\\n    --volume "${HOME}/.sentinelnode:/root/.sentinelnode" \\\n    --publish <API_PORT>:<API_PORT>/tcp \\\n    --publish <V2RAY_PORT>:<V2RAY_PORT>/tcp \\\n    sentinel-dvpn-node process start\n')),(0,a.kt)("h3",{id:"detach-from-the-screen-session"},"Detach from the screen session"),(0,a.kt)("p",null,"Detach from the node screen session"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ctrl+a+d\n")),(0,a.kt)("p",null,"To re-attach to the session type"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"screen -x dvpn\n")),(0,a.kt)("h2",{id:"post-node-run-commands"},"Post Node Run Commands"),(0,a.kt)("p",null,"Check if the node is running and visible to everyone. Open your browser and type the following URL"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"https://ip_node:tcp_port/status\n")),(0,a.kt)("p",null,"Node logs. You can specify a different number of logs if you need to view more or fewer entries"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker logs -f -n 100 sentinel-dvpn-node\n")),(0,a.kt)("p",null,"Container list/details"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker ps -a\n")),(0,a.kt)("p",null,"Restart a node (it stops and starts the node)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker restart sentinel-dvpn-node\n")),(0,a.kt)("p",null,"Stop a node"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker stop sentinel-dvpn-node\n")),(0,a.kt)("p",null,"Start a stopped node"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker start sentinel-dvpn-node\n")),(0,a.kt)("p",null,"Remove a node"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker rm -f sentinel-dvpn-node\n")))}c.isMDXComponent=!0}}]);